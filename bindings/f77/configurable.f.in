      subroutine plparseopts(mode)
      implicit none
      include 'sfstubs.h'
      integer mode
      integer maxargs, iargs, numargs, index, maxindex
      parameter(maxindex = maxlen/4)
      parameter (maxargs=20)
      character*(maxlen) arg
      integer*4 iargsarr(maxindex, maxargs)
      if(.not.@F77PARSE_CL@) then
        write(0,'(a)') 'PLPARSEOPTS not implemented on this fortran'//
     &    ' platform because iargc or getarg are not available'
        return
      endif
      numargs = iargc()
      if(numargs+1.gt.maxargs) then
        write(0,'(a)') 'PLPARSEOPTS: too many arguments'
        return
      endif
      do 10 iargs = 0, numargs
        call getarg(iargs, arg)
        call plstrf2c(arg, string1, maxlen)
        do 5 index = 1, maxindex
          iargsarr(index, iargs+1) = s1(index)
    5     continue
   10   continue
        call plparseopts7(numargs+1, iargsarr, mode, maxindex*4)
      end
