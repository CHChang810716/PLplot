c***********************************************************************
c  $Id$
c  sfstubs.f
c
c  Copyright (C) 2004  Alan W. Irwin
c
c  This file is part of PLplot.
c
c  PLplot is free software; you can redistribute it and/or modify
c  it under the terms of the GNU General Library Public License as published
c  by the Free Software Foundation; either version 2 of the License, or
c  (at your option) any later version.
c
c  PLplot is distributed in the hope that it will be useful,
c  but WITHOUT ANY WARRANTY; without even the implied warranty of
c  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
c  GNU Library General Public License for more details.
c
c  You should have received a copy of the GNU Library General Public License
c  along with PLplot; if not, write to the Free Software
c  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
c
c
c  This file contains the more complicated fortran stub routines
c  that the more generic scstubs.c cannot handle.
c  Typical stubs here must convert a fortran character string
c  to C or vice versa.
c  N.B. the called routines (that are defined in scstubs.c) have
c  a suffix of '7' to avoid name clashes and also presumably as a
c  signal in scstubs.c that they were called from these routines.
c  Where arguments are floating-point we explicitly type them as real*8.
c  This typing is never used since these arguments are
c  actually passed by reference.  That implies these routines should
c  work if the calling routine and libplplot itself are both
c  double precision or both single precision.
c
c***********************************************************************

      subroutine plsettransform(trcoef)

      implicit none
      real*8 trcoef(*)

      integer i
cDEC$ ATTRIBUTES DLLEXPORT :: PLPLOT
      real*8 tr(6)
      common /plplot/ tr

      do 100 i = 1,6
          tr(i) = trcoef(i)
  100 continue

      end

c***********************************************************************
      subroutine plsetopt(opt, optarg)

      implicit none
      character*(*) opt, optarg

      include 'sfstubs.h'

      call plstrf2c(opt, string1, maxlen)
      call plstrf2c(optarg, string2, maxlen)
      call plsetopt7(s1, s2)

      end

c***********************************************************************

      subroutine plabort(text)

      implicit none
      character*(*) text

      include 'sfstubs.h'

      call plstrf2c(text, string1, maxlen)
      call plabort7(s1)

      end

c***********************************************************************

      subroutine plsdev(dnam)

      implicit none
      character*(*) dnam

      include 'sfstubs.h'

      call plstrf2c(dnam, string1, maxlen)
      call plsdev7(s1)

      end

c***********************************************************************

      subroutine plgdev(dnam)

      implicit none
      character*(*) dnam

      include 'sfstubs.h'

      call plgdev7(string1)
      call plstrc2f(string1, dnam)

      end

c***********************************************************************

      subroutine plsfnam(fnam)

      implicit none
      character*(*) fnam

      include 'sfstubs.h'

      call plstrf2c(fnam, string1, maxlen)
      call plsfnam7(s1)

      end

c***********************************************************************

      subroutine plgfnam(fnam)

      implicit none
      character*(*) fnam

      include 'sfstubs.h'

      call plgfnam7(string1)
      call plstrc2f(string1, fnam)

      end

c***********************************************************************

      subroutine plgver(ver)

      implicit none
      character*(*) ver

      include 'sfstubs.h'

      call plgver7(s1)
      call plstrc2f(string1, ver)

      end

c***********************************************************************

      subroutine plaxes(x0,y0,xopt,xtick,nxsub,yopt,ytick,nysub)

      implicit none
      real*8 x0, y0, xtick, ytick
      integer nxsub, nysub
      character*(*) xopt,yopt

      include 'sfstubs.h'

      call plstrf2c(xopt, string1, maxlen)
      call plstrf2c(yopt, string2, maxlen)

      call plaxes7(x0,y0,s1,xtick,nxsub,s2,ytick,nysub)

      end

c***********************************************************************

      subroutine plbox(xopt,xtick,nxsub,yopt,ytick,nysub)

      implicit none
      real*8 xtick, ytick
      integer nxsub, nysub
      character*(*) xopt,yopt

      include 'sfstubs.h'

      call plstrf2c(xopt, string1, maxlen)
      call plstrf2c(yopt, string2, maxlen)

      call plbox7(s1,xtick,nxsub,s2,ytick,nysub)

      end

c***********************************************************************

      subroutine plbox3(xopt,xlabel,xtick,nxsub,yopt,ylabel,ytick,nysub,
     &  zopt,zlabel,ztick,nzsub)

      implicit none
      real*8 xtick, ytick, ztick
      character*(*) xopt,xlabel,yopt,ylabel,zopt,zlabel
      integer nxsub, nysub, nzsub

      include 'sfstubs.h'

      call plstrf2c(xopt, string1, maxlen)
      call plstrf2c(xlabel, string2, maxlen)
      call plstrf2c(yopt, string3, maxlen)
      call plstrf2c(ylabel, string4, maxlen)
      call plstrf2c(zopt, string5, maxlen)
      call plstrf2c(zlabel, string6, maxlen)

      call plbox37(s1,s2,xtick,nxsub,
     &  s3,s4,ytick,nysub,
     &  s5,s6,ztick,nzsub)

      end

c***********************************************************************

      subroutine plcon0(z,nx,ny,kx,lx,ky,ly,clevel,nlevel)

      implicit none
      integer nx, ny, kx, lx, ky, ly, nlevel
      real*8 z(nx, ny), clevel(nlevel)

      call plcon07(z,nx,ny,kx,lx,ky,ly,clevel,nlevel)

      end

c***********************************************************************

      subroutine plcon1(z,nx,ny,kx,lx,ky,ly,clevel,nlevel,xg,yg)

      implicit none
      integer nx, ny, kx, lx, ky, ly, nlevel
      real*8 z(nx, ny), xg(nx), yg(ny), clevel(nlevel)

      call plcon17(z,nx,ny,kx,lx,ky,ly,clevel,nlevel,xg,yg)

      end

c***********************************************************************

      subroutine plcon2(z,nx,ny,kx,lx,ky,ly,clevel,nlevel,xg,yg)

      implicit none
      integer nx, ny, kx, lx, ky, ly, nlevel
      real*8 z(nx, ny), xg(nx, ny), yg(nx, ny), clevel(nlevel)

      call plcon27(z,nx,ny,kx,lx,ky,ly,clevel,nlevel,xg,yg)

      end

c***********************************************************************

      subroutine plcont(z,nx,ny,kx,lx,ky,ly,clevel,nlevel)

      implicit none
      integer nx, ny, kx, lx, ky, ly, nlevel
      real*8 z(nx, ny), clevel(nlevel)
      real*8 tr(6)

cDEC$ ATTRIBUTES DLLEXPORT :: PLPLOT
      common /plplot/ tr

      call plcont7(z,nx,ny,kx,lx,ky,ly,clevel,nlevel,tr)

      end

c***********************************************************************

      subroutine plvec0(u, v, nx, ny, scale)

      implicit none
      integer nx, ny
      real*8 u(nx, ny), v(nx, ny), scale

      call plvec07(u,v,nx,ny,scale)

      end

c***********************************************************************

      subroutine plvec1(u, v, nx, ny, scale, xg, yg)

      implicit none
      integer nx, ny
      real*8 u(nx, ny), v(nx,ny), xg(nx), yg(ny), scale

      call plvec17(u,v,nx,ny,scale,xg,yg)

      end

c***********************************************************************

      subroutine plvec2(u, v, nx, ny, scale, xg, yg)

      implicit none
      integer nx, ny
      real*8 u(nx, ny), v(nx,ny), xg(nx, ny), yg(nx, ny), scale

      call plvec27(u,v,nx,ny,scale,xg,yg)

      end

c***********************************************************************

      subroutine plvect(u, v, nx, ny, scale)

      implicit none
      integer nx, ny
      real*8 u(nx, ny), v(nx,ny), scale
      real*8 tr(6)
      common /plplot/ tr

      call plvect7(u,v,nx,ny,scale,tr)

      end

c***********************************************************************

      subroutine plshade0(z, nx, ny, defined,
     &  xmin, xmax, ymin, ymax,
     &  shade_min, shade_max,
     &  sh_cmap, sh_color, sh_width,
     &  min_color, min_width, max_color, max_width, lx)

      implicit none
      character defined*(*)
      integer nx, ny, sh_cmap, sh_width, lx
      integer min_color, min_width, max_color, max_width
      real*8 shade_min, shade_max, sh_color
      real*8 z(nx, ny), xmin, xmax, ymin, ymax

      include 'sfstubs.h'

c	call plstrf2c(dnam, string1, maxlen)

      call plshade07(z, nx, ny, s1,
     &  xmin, xmax, ymin, ymax,
     &  shade_min, shade_max,
     &  sh_cmap, sh_color, sh_width,
     &  min_color, min_width, max_color, max_width, lx)

      end

c***********************************************************************

      subroutine plshade1(z, nx, ny, defined,
     &  xmin, xmax, ymin, ymax,
     &  shade_min, shade_max,
     &  sh_cmap, sh_color, sh_width,
     &  min_color, min_width, max_color, max_width,
     &  xg, yg, lx)

      implicit none
      character defined*(*)
      integer nx, ny, sh_cmap, sh_width, lx
      integer min_color, min_width, max_color, max_width
      real*8 shade_min, shade_max, sh_color
      real*8 z(nx, ny), xmin, xmax, ymin, ymax, xg(nx), yg(ny)

      include 'sfstubs.h'

c	call plstrf2c(dnam, string1, maxlen)

      call plshade17(z, nx, ny, s1,
     &  xmin, xmax, ymin, ymax,
     &  shade_min, shade_max,
     &  sh_cmap, sh_color, sh_width,
     &  min_color, min_width, max_color, max_width,
     &  xg, yg, lx)

      end

c***********************************************************************

      subroutine plshade2(z, nx, ny, defined,
     &  xmin, xmax, ymin, ymax,
     &  shade_min, shade_max,
     &  sh_cmap, sh_color, sh_width,
     &  min_color, min_width, max_color, max_width,
     &  xg, yg, lx)

      implicit none
      character defined*(*)
      integer nx, ny, sh_cmap, sh_width, lx
      integer min_color, min_width, max_color, max_width
      real*8 shade_min, shade_max, sh_color
      real*8 z(nx, ny), xmin, xmax, ymin, ymax, xg(nx, ny), yg(nx, ny)

      include 'sfstubs.h'

c	call plstrf2c(dnam, string1, maxlen)

      call plshade27(z, nx, ny, s1,
     &  xmin, xmax, ymin, ymax,
     &  shade_min, shade_max,
     &  sh_cmap, sh_color, sh_width,
     &  min_color, min_width, max_color, max_width,
     &  xg, yg, lx)

      end

c***********************************************************************

      subroutine plshade(z, nx, ny, defined,
     &  xmin, xmax, ymin, ymax,
     &  shade_min, shade_max,
     &  sh_cmap, sh_color, sh_width,
     &  min_color, min_width, max_color, max_width, lx)

      implicit none
      character defined*(*)
      integer nx, ny, sh_cmap, sh_width, lx
      integer min_color, min_width, max_color, max_width
      real*8 shade_min, shade_max, sh_color
      real*8 z(nx, ny), xmin, xmax, ymin, ymax
      real*8 tr(6)
      common /plplot/ tr

      include 'sfstubs.h'

      call plshade7(z, nx, ny, s1,
     &  xmin, xmax, ymin, ymax,
     &  shade_min, shade_max,
     &  sh_cmap, sh_color, sh_width,
     &  min_color, min_width, max_color, max_width, tr, lx)

      end

c***********************************************************************

      subroutine plshades0(z, nx, ny, defined,
     &  xmin, xmax, ymin, ymax,
     &  clevel, nlevel, fill_width,
     &  cont_color, cont_width, lx)

      implicit none
      character defined*(*)
      integer nx, ny, nlevel, fill_width, cont_color, cont_width, lx
      real*8 clevel(nlevel)
      real*8 z(lx, ny), xmin, xmax, ymin, ymax

      include 'sfstubs.h'

c	call plstrf2c(dnam, string1, maxlen)

      call plshades07(z, nx, ny, s1,
     &  xmin, xmax, ymin, ymax,
     &  clevel, nlevel, fill_width,
     &  cont_color, cont_width, lx)

      end

c***********************************************************************

      subroutine plshades1(z, nx, ny, defined,
     &  xmin, xmax, ymin, ymax,
     &  clevel, nlevel, fill_width,
     &  cont_color, cont_width, xg1, yg1, lx)

      implicit none
      character defined*(*)
      integer nx, ny, nlevel, fill_width, cont_color, cont_width, lx
      real*8 clevel(nlevel)
      real*8 z(lx, ny), xmin, xmax, ymin, ymax, xg1(nx), yg1(ny)

      include 'sfstubs.h'

c	call plstrf2c(dnam, string1, maxlen)

      call plshades17(z, nx, ny, s1,
     &  xmin, xmax, ymin, ymax,
     &  clevel, nlevel, fill_width,
     &  cont_color, cont_width, xg1, yg1, lx)

      end

c***********************************************************************

      subroutine plshades2(z, nx, ny, defined,
     &  xmin, xmax, ymin, ymax,
     &  clevel, nlevel, fill_width,
     &  cont_color, cont_width, xg2, yg2, lx)

      implicit none
      character defined*(*)
      integer nx, ny, nlevel, fill_width, cont_color, cont_width, lx
      real*8 clevel(nlevel)
      real*8 z(lx, ny), xmin, xmax, ymin, ymax,
     &  xg2(lx, ny), yg2(lx, ny)

      include 'sfstubs.h'

c	call plstrf2c(dnam, string1, maxlen)

      call plshades27(z, nx, ny, s1,
     &  xmin, xmax, ymin, ymax,
     &  clevel, nlevel, fill_width,
     &  cont_color, cont_width, xg2, yg2, lx)

      end

c***********************************************************************

      subroutine plshades(z, nx, ny, defined,
     &  xmin, xmax, ymin, ymax,
     &  clevel, nlevel, fill_width,
     &  cont_color, cont_width, lx)

      implicit none
      character defined*(*)
      integer nx, ny, nlevel, fill_width, cont_color, cont_width, lx
      real*8 clevel(nlevel)
      real*8 z(nx, ny), xmin, xmax, ymin, ymax
      real*8 tr(6)
      common /plplot/ tr

      include 'sfstubs.h'

c	call plstrf2c(dnam, string1, maxlen)

      call plshades7(z, nx, ny, s1,
     &  xmin, xmax, ymin, ymax,
     &  clevel, nlevel, fill_width,
     &  cont_color, cont_width, tr, lx)

      end

c***********************************************************************

      subroutine plimagefr0(z,nx,ny,xmin,xmax,ymin,ymax,zmin,zmax,
     &     valuemin,valuemax,lx)

      implicit none
      integer nx, ny, lx
      real*8 z(nx, ny)
      real*8 xmin, xmax, ymin, ymax, zmin, zmax, valuemin, valuemax

      call plimagefr07(z,nx,ny,xmin,xmax,ymin,ymax,zmin,zmax,
     &     valuemin,valuemax,lx)

      end

c***********************************************************************

      subroutine plimagefr1(z,nx,ny,xmin,xmax,ymin,ymax,zmin,zmax,
     &     valuemin,valuemax,xg,yg,lx)

      implicit none
      integer nx, ny, lx
      real*8 z(nx, ny), xg(nx), yg(ny)
      real*8 xmin, xmax, ymin, ymax, zmin, zmax, valuemin, valuemax

      call plimagefr17(z,nx,ny,xmin,xmax,ymin,ymax,zmin,zmax,
     &     valuemin,valuemax,xg,yg,lx)

      end

c***********************************************************************

      subroutine plimagefr2(z,nx,ny,xmin,xmax,ymin,ymax,zmin,zmax,
     &     valuemin,valuemax,xg,yg,lx)

      implicit none
      integer nx, ny, lx
      real*8 z(nx, ny), xg(nx,ny), yg(nx,ny)
      real*8 xmin, xmax, ymin, ymax, zmin, zmax, valuemin, valuemax

      call plimagefr27(z,nx,ny,xmin,xmax,ymin,ymax,zmin,zmax,
     &     valuemin,valuemax,xg,yg,lx)

      end

c***********************************************************************

      subroutine plimagefr(z,nx,ny,xmin,xmax,ymin,ymax,zmin,zmax,
     &     valuemin,valuemax,lx)

      implicit none
      integer nx, ny, lx
      real*8 z(nx, ny)
      real*8 xmin, xmax, ymin, ymax, zmin, zmax, valuemin, valuemax
      real*8 tr(6)
      common /plplot/ tr

      call plimagefr7(z,nx,ny,xmin,xmax,ymin,ymax,zmin,zmax,
     &     valuemin,valuemax,tr,lx)

      end

c***********************************************************************

      subroutine pllab(xlab,ylab,title)

      implicit none
      character*(*) xlab,ylab,title

      include 'sfstubs.h'

      call plstrf2c(xlab, string1, maxlen)
      call plstrf2c(ylab, string2, maxlen)
      call plstrf2c(title, string3, maxlen)

      call pllab7(s1,s2,s3)

      end

c***********************************************************************

      subroutine plspal0(filename)

      implicit none
      character*(*) filename

      include 'sfstubs.h'

      call plstrf2c(filename, string1, maxlen)

      call plspal07(s1)

      end

c***********************************************************************

      subroutine plspal1(filename,interpolate)

      implicit none
      character*(*) filename
      integer interpolate

      include 'sfstubs.h'

      call plstrf2c(filename, string1, maxlen)

      call plspal17(s1,interpolate)

      end

c***********************************************************************

      subroutine plmtex(side,disp,pos,xjust,text)

      implicit none
      real*8 disp, pos, xjust
      character*(*) side, text

      include 'sfstubs.h'

      call plstrf2c(side, string1, maxlen)
      call plstrf2c(text, string2, maxlen)

      call plmtex7(s1,disp,pos,xjust,s2)

      end

c***********************************************************************

      subroutine plmtex3(side,disp,pos,xjust,text)

      implicit none
      real*8 disp, pos, xjust
      character*(*) side, text

      include 'sfstubs.h'

      call plstrf2c(side, string1, maxlen)
      call plstrf2c(text, string2, maxlen)

      call plmtex37(s1,disp,pos,xjust,s2)

      end

c***********************************************************************

      subroutine plptex(x,y,dx,dy,xjust,text)

      implicit none
      real*8 x, y, dx, dy, xjust
      character*(*) text

      include 'sfstubs.h'

      call plstrf2c(text, string1, maxlen)

      call plptex7(x,y,dx,dy,xjust,s1)

      end

c***********************************************************************

      subroutine plptex3(x,y,z,dx,dy,dz,sx,sy,sz,xjust,text)

      implicit none
      real*8 x, y, z, dx, dy, dz, sx, sy, sz, xjust
      character*(*) text

      include 'sfstubs.h'

      call plstrf2c(text, string1, maxlen)

      call plptex37(x,y,z,dx,dy,dz,sx,sy,sz,xjust,s1)

      end

c***********************************************************************

      subroutine plstart(devname, nx, ny)

      implicit none
      character*(*) devname
      integer nx, ny

      include 'sfstubs.h'

      call plstrf2c(devname, string1, maxlen)

      call plstart7(s1, nx, ny)

      end

c***********************************************************************

      subroutine plmap(mapform,mapname,minx,maxx,miny,maxy)

      implicit none
      real*8 minx, maxx, miny, maxy
      character*(*) mapname
      external mapform

      include 'sfstubs.h'

      call plstrf2c(mapname, string1, maxlen)

      call plsetmapformc(mapform)
      call plmap7(s1,minx,maxx,miny,maxy)

      end

c***********************************************************************

      subroutine plmap_none(mapname,minx,maxx,miny,maxy)

      implicit none
      real*8 minx, maxx, miny, maxy
      character*(*) mapname

      include 'sfstubs.h'

      call plstrf2c(mapname, string1, maxlen)

      call plclearmapformc()
      call plmap7(s1,minx,maxx,miny,maxy)

      end

c***********************************************************************

      subroutine plmeridians(mapform,dlong,dlat,minlong,maxlong,
     &                       minlat,maxlat)

      implicit none
      real*8 dlong, dlat, minlong, maxlong, minlat, maxlat
      external mapform

      include 'sfstubs.h'

      call plsetmapformc(mapform)
      call plmeridians7(dlong,dlat,minlong,maxlong,minlat,maxlat)

      end


c***********************************************************************

      subroutine plmeridians_none(dlong,dlat,minlong,maxlong,
     &                       minlat,maxlat)

      implicit none
      real*8 dlong, dlat, minlong, maxlong, minlat, maxlat

      include 'sfstubs.h'

      call plclearmapformc()
      call plmeridians7(dlong,dlat,minlong,maxlong,minlat,maxlat)

      end


c***********************************************************************

      subroutine plstring(n,x,y,string)

      implicit none
      integer n
      real*8 x(n), y(n)
      character*(*) string

      include 'sfstubs.h'

      call plstrf2c(string,s1,maxlen)
      call plstring7(n,x,y,s1)

      end


c***********************************************************************

      subroutine plstripc(id, xspec, yspec, xmin, xmax, xjump,
     &  ymin, ymax, xlpos, ylpos, y_ascl, acc,
     &  colbox, collab, colline, styline, legline,
     &  labx, laby, labtop)

      implicit none
      integer id, y_ascl, acc, colbox, collab, colline(4), styline(4)
      character*(*) xspec, yspec, legline(4), labx, laby, labtop
      real*8 xmin, xmax, xjump, ymin, ymax, xlpos, ylpos
      integer nx, ny

      include 'sfstubs.h'

      call plstrf2c(xspec, string1, maxlen)
      call plstrf2c(yspec, string2, maxlen)
      call plstrf2c(legline(1), string3, maxlen)
      call plstrf2c(legline(2), string4, maxlen)
      call plstrf2c(legline(3), string5, maxlen)
      call plstrf2c(legline(4), string6, maxlen)
      call plstrf2c(labx, string7, maxlen)
      call plstrf2c(laby, string8, maxlen)
      call plstrf2c(labtop, string9, maxlen)

      call plstripc7(id, s1, s2, xmin, xmax, xjump,
     &  ymin, ymax, xlpos, ylpos, y_ascl, acc,
     &  colbox, collab, colline, styline,
     &  s3, s4, s5, s6,
     &  s7, s8, s9)

      end

c***********************************************************************

      subroutine pltimefmt(fmt)

      implicit none
      character*(*) fmt

      include 'sfstubs.h'

      call plstrf2c(fmt, string1, maxlen)
      call pltimefmt7(s1)

      end

c***********************************************************************
