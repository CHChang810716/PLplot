This directory contains 'TEA-complaint' configuration and makefiles
to compile Plplot as a set of extensions to Tcl.  'TEA' stands for
'Tcl Extension Architecture' and is the modern way to build extensions
for Tcl so that they can be easily recompiled on any Tcl platform.

Note that in the instructions below, the 'autoconf' step is optional, 
since we provide a correctly generated configure file.

Note the current configuration is crude (but direct) and independent of
ordinary plplot configuration (except for the plDevs.h and PlConfig.h files
generated by that configuration, see below).  Later the two configurations
will be merged, but for simplicity they are separate now.

(1) cd ../tcl-matrix and install that package according to the Readme.txt
there.  Note that it is important the install location there is the same
as the install location here.

(2) 
cd ../..
./configure
#this last step does all sorts of things, but the only thing relevant to us
is it creates plDevs.h and plConfig.h in ../../tmp.

(3) cd bindings/tcl-pltk #return back to this directory 
edit ../../tmp/plDevs.h to make sure it contains both the tk driver and the
tkwin driver (#define PLD_tkwin 1), but not the xwin driver.  Note this
definition of drivers is different than for the tcl-pltcl case, but we will
coordinate the two eventually in a more automatic configuration. Note also
that this current tcl-pltk package depends on the tcl-matrix package (see 1
above), but is completely independent of tcl-pltcl.

----------------------

On windows (using cygwin --- see www.scriptics.com for more
instructions), the following sort of thing should suffice:

(in the bash shell):

% autoconf
% ../configure --with-tcl=//d/tcl-source/tcl8.3.1/win/Release
--with-tclinclude=//d/tcl-source/tcl8.3.1/generic
--with-tk=//d/tcl-source/tk8.3.1/generic
--prefix=//d/progra~1/tcl

% make
% make install

'with-tcl' is the location of tclConfig.sh (this requirement may be
lifted in a future version of TEA).
'with-tclinclude' is the location of tcl.h
'with-tk' is the location of tkConfig.sh (this requirement may be
lifted in a future version of TEA).
'prefix' is the install location

You may also wish to add 'exec-prefix' for a platform specific
installation location (otherwise prefix/bin will be used).

----------------------

On Linux (Debian system with a user-defined install region right in
the plplot tree for testing purposes).
autoconf
./configure --with-tcl=/usr/lib --with-tk=/usr/lib \
--with-tclinclude=/usr/include/tcl8.2/generic \
--prefix=../testinstalldir

N.B. Must edit Makefile until Vince puts these changes
properly into Makefile.in.  The changes are to include
tcpip and define TK_TOP_DIR_NATIVE properly (which current
configure script fails to do correctly on Linux system because
it assumes header files are in a flat directory structure).
Patch between correct Makefile (tcl8.2 Linux) and one generated by 
./configure is
**********************************
--- Makefile_generated	Fri Jul 28 12:35:20 2000
+++ Makefile	Fri Jul 28 12:45:21 2000
@@ -34,7 +34,7 @@
 
 Pltcl_SOURCES = ../tcl/tclAPI.c ../tcl/ckcalloc.c
 
-Pltk_SOURCES = ../tk/plframe.c ../tk/Pltk_Init.c ../tk/plr.c
+Pltk_SOURCES = ../tk/plframe.c ../tk/Pltk_Init.c ../tk/plr.c ../tk/tcpip.c
 
 Pldriver_SOURCES = \
 ../../drivers/dg300.c ../../drivers/hpgl.c ../../drivers/impress.c \
@@ -65,7 +65,7 @@
 #========================================================================
 
 Pltk_OBJECTS =  tclAPI.$(OBJEXT) ckcalloc.$(OBJEXT) \
-plframe.$(OBJEXT) Pltk_Init.$(OBJEXT) plr.$(OBJEXT) \
+plframe.$(OBJEXT) Pltk_Init.$(OBJEXT) plr.$(OBJEXT) tcpip.$(OBJEXT) \
 pdfutils.$(OBJEXT) plargs.$(OBJEXT) plbox.$(OBJEXT) \
 plcont.$(OBJEXT) plcore.$(OBJEXT) plctrl.$(OBJEXT) \
 plcvt.$(OBJEXT) pldtik.$(OBJEXT) plfill.$(OBJEXT) \
@@ -226,6 +226,7 @@
 AUTOCONF = autoconf
 
 LDFLAGS = $(LDFLAGS_DEFAULT)
+TK_TOP_DIR_NATIVE = /usr/include/tk8.2
 
 INCLUDES = -I"/usr/include/tcl8.2/generic" -I$(TK_TOP_DIR_NATIVE)/generic -I$(TK_TOP_DIR_NATIVE)/unix $(Pltk_INCLUDES)
 
@@ -387,6 +388,9 @@
 
 plr.$(OBJEXT): $(srcdir)/../tk/plr.c
 	$(COMPILE) -c `echo $(srcdir)/../tk/plr.c` -o $@
+
+tcpip.$(OBJEXT): $(srcdir)/../tk/tcpip.c
+	$(COMPILE) -c `echo $(srcdir)/../tk/tcpip.c` -o $@
 
 plframe.$(OBJEXT): $(srcdir)/../tk/plframe.c
 	$(COMPILE) -c `echo $(srcdir)/../tk/plframe.c` -o $@
**********************************
After Makefile editing is complete execute the following:

make

The following is done as ordinary user since ../testinstalldir is in a normal
user account directory tree.  

Also note that you need access to the X server for this to work since wish
is invoked by make install.  Normally to get access to the X server you need
to setenv DISPLAY computername:0.0 in the account where the install is
occurring and do X authorization (by xhost on simple systems) in the account
which is running the X server.

make install

Testing
#cd to install location
cd ../testinstalldir/lib
setenv PL_LIBRARY `pwd`/plplot5.1
wish
% #this next is required because of non-standard install location
% #use full path name before testinstalldir
% lappend auto_path [pwd]
% package require Pltk
5.1
% cd ../../../examples/tk
% source tea_tkdemos.tcl
% 1
% 2
etc....

----------------------

Not tested yet on other unices, but should probably work.
