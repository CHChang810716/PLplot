<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.1p1 release (March 2nd, 1998)
originally by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Three Dimensional Surface Plots</TITLE>
<META NAME="description" CONTENT="Three Dimensional Surface Plots">
<META NAME="keywords" CONTENT="plplot">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="plplot.css">
<LINK REL="next" HREF="node37.html">
<LINK REL="previous" HREF="node35.html">
<LINK REL="up" HREF="node24.html">
<LINK REL="next" HREF="node37.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html657"
 HREF="node37.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="icons.gif/next_motif.gif"></A> 
<A NAME="tex2html653"
 HREF="node24.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="icons.gif/up_motif.gif"></A> 
<A NAME="tex2html647"
 HREF="node35.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="icons.gif/previous_motif.gif"></A> 
<A NAME="tex2html655"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="icons.gif/contents_motif.gif"></A> 
<A NAME="tex2html656"
 HREF="node75.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="icons.gif/index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html658"
 HREF="node37.html">Contour and Shade Plots</A>
<B> Up:</B> <A NAME="tex2html654"
 HREF="node24.html">Advanced Use of PLplot</A>
<B> Previous:</B> <A NAME="tex2html648"
 HREF="node35.html">Escape Sequences in Text</A>
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION032120000000000000000">
Three Dimensional Surface Plots</A>
</H1>
3-d plots
Surface plots

<P>
PLplot includes routines that will represent a single-valued function of
two variables as a surface.  In this section, we shall assume that the
function to be plotted is Z[X][Y], where Z represents the
dependent variable and X and Y represent the independent
variables.

<P>
As usual, we would like to refer to a three dimensional point (X,
Y, Z) in terms of some meaningful user-specified coordinate system.
These are called <EM>three-dimensional world coordinates</EM>.  We need to
specify the ranges of these coordinates, so that the entire surface is
contained within the cuboid defined by
xmin&lt;x&lt;xmax, ymin&lt;y&lt;ymax
and zmin&lt;z&lt;zmax.  Typically, we shall want to
view the surface from a variety of angles, and to facilitate this, a
two-stage mapping of the enclosing cuboid is performed.  Firstly, it is
mapped into another cuboid called the <EM>normalized box</EM> whose size
must also be specified by the user, and secondly this normalized box is
viewed from a particular azimuth and elevation so that it can be
projected onto the two-dimensional window.

<P>
This two-stage transformation process allows considerable flexibility in
specifying how the surface is depicted.  The lengths of the sides of the
normalized box are independent of the world coordinate ranges of each of
the variables, making it possible to use ``reasonable'' viewing angles
even if the ranges of the world coordinates on the axes are very
different.  The size of the normalized box is determined essentially by
the size of the two-dimensional window into which it is to be mapped.
The normalized box is centered about the origin in the x and y
directions, but rests on the plane z = 0.  It is viewed by an
observer located at altitude alt and azimuth az, where
both angles are measured in degrees.  The altitude should be restricted
to the range zero to ninety degrees for proper operation, and represents
the viewing angle above the xy plane.  The azimuth is defined so that
when az = 0, the observer sees the xz plane face on, and as the
angle is increased, the observer moves clockwise around the box as
viewed from above the xy plane.  The azimuth can take on any
value.

<P>
The first step in drawing a surface plot is to decide on the size of the
two-dimensional window and the normalized box.  For example, we could
choose the normalized box to have sides of length

<P>
<PRE>
    basex = 2.0;
    basey = 4.0;
    height = 3.0;
</PRE>
<P>
<BR>
<IMG
 WIDTH="42" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img14.gif"
 ALT="\begin{tex}A reasonable range for the x coordinate of the two-dimensional window...
...across the base of the
normalized box is $\sqrt{2^2+4^2} = 2\sqrt{5}$ ,\end{tex}">
<BR>
<BR>
<IMG
 WIDTH="546" HEIGHT="30" ALIGN="BOTTOM" BORDER="0"
 SRC="img15.gif"
 ALT="\begin{ifinfo}A reasonable range for the x coordinate of the two-dimensional win...
... across the base of the
normalized box is sqrt(2^2+4^2) = 2 sqrt(5),\end{ifinfo}">
<BR>
which fits into this coordinate range.  A reasonable range for the y
coordinate of the two dimensional window in this case is -2.5 to +4, as
the the projection of the normalized box lies in this range for the
allowed range of viewing angles.

<P>
The routine plwind or plenv is used in the usual way to
establish the size of the two-dimensional window.  The routine
plw3d must then be called to establish the range of the three
dimensional world coordinates, the size of the normalized box and the
viewing angles.  After calling plw3d, the actual surface is drawn
by a call to plot3d.

<P>
For example, if the three-dimensional world-coordinate ranges are
<BR>
<IMG
 WIDTH="42" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img16.gif"
 ALT="\begin{tex}$-10.0\le\code{x}\le 10.0$ , $-3.0\le\code{y}\le +7.0$\space and
$0.0\le\code{z}\le 8.0$ ,
\end{tex}">
<BR>
<BR>
<IMG
 WIDTH="479" HEIGHT="30" ALIGN="BOTTOM" BORDER="0"
 SRC="img17.gif"
 ALT="\begin{ifinfo}-10.0 <= \code{x} <= 10.0, -3.0 <= \code{y} <= +7.0 and
0.0 <= \code{z} <= 8.0,
\end{ifinfo}">
<BR>
we could use the following statements:

<P>
<PRE>
    xmin2d = -2.5;
    xmax2d =  2.5;
    ymin2d = -2.5;
    ymax2d =  4.0;
    plenv(xmin2d, xmax2d, ymin2d, ymax2d, 0, -2);
    basex = 2.0;
    basey = 4.0;
    height = 3.0;
    xmin = -10.0;
    xmax = 10.0;
    ymin = -3.0;
    ymax = 7.0;
    zmin = 0.0;
    zmax = 8.0;
    alt = 45.0;
    az = 30.0;
    side = 1;
    plw3d(basex, basey, height, xmin, xmax, ymin, ymax, zmin, zmax, alt, az);
    plot3d(x, y, z, nx, ny, opt, side);
</PRE>
<P>
The values of the function are stored in a two-dimensional array
z[][] where the array element z[i][j] contains the value
of the function at the point x_i, y_j.  (The two-dimensional array
z is a vectored array instead of a fixed size array.  z
points to an array of pointers which each point to a rwo of the matrix.)
Note that the values of the independent variables x_i and y_j do not
need to be equally spaced, but they must lie on a rectangular grid.
Thus two further arrays x[nx] and y[ny] are required as
arguments to plot3d to specify the values of the independent
variables.  The values in the arrays x and y must be strictly increasing
with the index.  The argument opt specifies how the surface is
outlined.  If opt = 1, a line is drawn representing z as a
function of x for each value of y, if opt = 2, a line is drawn
representing z as a function of y for each value of x, and if opt
= 3, a net of lines is drawn.  The first two options may be preferable
if one of the independent variables is to be regarded as a parameter,
whilst the third is better for getting an overall picture of the
surface.  If side is equal to one then sides are drawn on the figure so
that the graph doesn't appear to float.

<P>
The routine plmesh is similar to plot3d, except that it is
used for drawing mesh plots.  Mesh plots allow you to see both the top
and bottom sides of a surface mesh, while 3D plots allow you to see the
top side only (like looking at a solid object).  The side option is not
available with plmesh.

<P>
Labelling a three-dimensional or mesh plot is somewhat more complicated
than a two dimensional plot due to the need for skewing the characters
in the label so that they are parallel to the coordinate axes.  The
routine plbox3 thus combines the functions of box drawing and
labelling.

<P>
Contour plots, , 3-d Plots, Advanced Use

<HR>
<!--Navigation Panel-->
<A NAME="tex2html657"
 HREF="node37.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="icons.gif/next_motif.gif"></A> 
<A NAME="tex2html653"
 HREF="node24.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="icons.gif/up_motif.gif"></A> 
<A NAME="tex2html647"
 HREF="node35.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="icons.gif/previous_motif.gif"></A> 
<A NAME="tex2html655"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="icons.gif/contents_motif.gif"></A> 
<A NAME="tex2html656"
 HREF="node75.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="icons.gif/index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html658"
 HREF="node37.html">Contour and Shade Plots</A>
<B> Up:</B> <A NAME="tex2html654"
 HREF="node24.html">Advanced Use of PLplot</A>
<B> Previous:</B> <A NAME="tex2html648"
 HREF="node35.html">Escape Sequences in Text</A>
<!--End of Navigation Panel-->
<ADDRESS>
<I>Noel Gorelick</I>
<BR><I>1998-04-02</I>
</ADDRESS>
</BODY>
</HTML>
