<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.1p1 release (March 2nd, 1998)
originally by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Contour Plots from Fortran</TITLE>
<META NAME="description" CONTENT="Contour Plots from Fortran">
<META NAME="keywords" CONTENT="plplot">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="plplot.css">
<LINK REL="previous" HREF="node38.html">
<LINK REL="up" HREF="node37.html">
<LINK REL="next" HREF="node40.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html691"
 HREF="node40.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="icons.gif/next_motif.gif"></A> 
<A NAME="tex2html687"
 HREF="node37.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="icons.gif/up_motif.gif"></A> 
<A NAME="tex2html683"
 HREF="node38.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="icons.gif/previous_motif.gif"></A> 
<A NAME="tex2html689"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="icons.gif/contents_motif.gif"></A> 
<A NAME="tex2html690"
 HREF="node75.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="icons.gif/index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html692"
 HREF="node40.html">The PLplot X Driver</A>
<B> Up:</B> <A NAME="tex2html688"
 HREF="node37.html">Contour and Shade Plots</A>
<B> Previous:</B> <A NAME="tex2html684"
 HREF="node38.html">Contour Plots from C</A>
<BR>
<BR>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION032132000000000000000">
Contour Plots from Fortran</A>
</H2>
Contour Plots - Fortran

<P>
The routines mentioned above are not recommended for use directly from
Fortran due to the need to pass a function pointer.  That is, the
transformation function is written in C and can not generally be changed
by the user.  The call for routine plcont from Fortran is
then:

<P>
call plcont(z, nx, ny, kx, lx, ky, ly, clevel, nlevel, tr) 

<P>
where tr is a 6 element array with the coefficients for the
transformation function xform given above and all other arguments
are the same as in the call from C (see above discussion of
plcont).

<P>
The three routines recommended for use from Fortran are plcon0,
plcon1, and plcon2.  These routines are similar to existing
commercial plot package contour plotters in that they offer successively
higher complexity, with plcon0 utilizing no transformation
arrays, while those used by plcon1 and plcon2 are one and
two dimensional, respectively.  The call syntax for each is

<P>
call plcon0(z, nx, ny, kx, lx, ky, ly, clevel, nlevel) 
call plcon1(z, nx, ny, kx, lx, ky, ly, clevel, nlevel, xg1, yg1) 
call plcon2(z, nx, ny, kx, lx, ky, ly, clevel, nlevel, xg2, yg2) 

<P>
The plcon0 routine is implemented via a call to plcont
with a very simple (identity) transformation function, while
plcon1 and plcon2 use interpolating transformation
functions in a call to plconf.

<P>
The transformation arrays are used by these routines to specify a
mapping between the computational coordinate system and the physical
one.  For example, the transformation to polar coordinates might look
like:

<P>
<PRE>
    do i = 1, NX
        do j = 1, NY
            xg(i, j) = r(i) * cos( theta(j) )
            yg(i, j) = r(i) * sin( theta(j) )
        enddo
    enddo
</PRE>
<P>
example program 9).

<P>
The transformation function not only specifies the transformation at grid
points, but also at intermediate locations, via linear interpolation.  For
example, in the pltr1 transformation function used by plcon1, 
the 1-d interpolation to get tx as a function of x 
looks like (in C):

<P>
<PRE>
    ul = (PLINT)x;
    ur = ul + 1;
    du = x - ul;

    xl = *(xg+ul);
    xr = *(xg+ur);

    *tx = xl * (1-du)  +  xr * du;
</PRE>
<P>
while in Fortran this might look like:

<P>
<PRE>
    lxl = x
    lxr = lxl + 1
    dx = x - lxl

    xl = xg(lxl)
    xr = xg(lxr)

    tx = xl * (1-dx)  +  xr * dx
</PRE>
<P>
X Windows Drivers, Other Drivers, Advanced Use, Top
<HR>
<!--Navigation Panel-->
<A NAME="tex2html691"
 HREF="node40.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="icons.gif/next_motif.gif"></A> 
<A NAME="tex2html687"
 HREF="node37.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="icons.gif/up_motif.gif"></A> 
<A NAME="tex2html683"
 HREF="node38.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="icons.gif/previous_motif.gif"></A> 
<A NAME="tex2html689"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="icons.gif/contents_motif.gif"></A> 
<A NAME="tex2html690"
 HREF="node75.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="icons.gif/index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html692"
 HREF="node40.html">The PLplot X Driver</A>
<B> Up:</B> <A NAME="tex2html688"
 HREF="node37.html">Contour and Shade Plots</A>
<B> Previous:</B> <A NAME="tex2html684"
 HREF="node38.html">Contour Plots from C</A>
<!--End of Navigation Panel-->
<ADDRESS>
<I>Noel Gorelick</I>
<BR><I>1998-04-02</I>
</ADDRESS>
</BODY>
</HTML>
