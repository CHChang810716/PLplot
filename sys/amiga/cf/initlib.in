# -----------------------------------------------------------------------
# $Id$
#
# Maurice LeBrun
# IFS, University of Texas at Austin
# 24-Jul-1994
#
# Initializations for building PLplot library.
# -----------------------------------------------------------------------

# Compiler flags

CC_FLAGS	= $(MATHFLAGS) $(DBL_FLAG_C) nover $(DEBUG_FLAG_C) \
		  idir=$(PLINC_DIR) $(OPT_FLAG_C) gst=plplot.gst \
		  ign=84,88,89,147,161 

CC_FLAGS_DEMOS	= $(CC_FLAGS)

# Default is to build library(s) and utils.

everything: libs plrender$E $(TCL_EXE) 

# Clear the suffix list to prevent problems.

.SUFFIXES:
.SUFFIXES: $O .cc .c .f .h .fm4

# Inference rules, not specific to archive or shared libraries.

.fm4.f:
	$(M4) $(M4_FLAGS) $< >$*.f

# -----------------------------------------------------------------------
# Amiga-specific files
# -----------------------------------------------------------------------

AMIGA_OBJ = \
	pla_wn.o \
	pla_pr.o \
	pla_iff.o \
	pla_menu.o \
	plsupport.o 

# -----------------------------------------------------------------------
# Amiga-specific dependencies
# -----------------------------------------------------------------------

pla_pr.o:	plplotP.h plplot.h drivers.h pdf.h plstream.h plamiga.h \
		pla_pr.c
pla_iff.o:	plplotP.h plplot.h drivers.h pdf.h plstream.h plamiga.h \
		pla_iff.c
pla_menu.o:	plplotP.h plplot.h plamiga.h pla_menu.c
plsupport.o:	plplotP.h plplot.h plamiga.h plsupport.c
pla_wn.o:	plplotP.h plplot.h drivers.h pdf.h plstream.h plamiga.h \
		pla_wn.c

# -----------------------------------------------------------------------
# This builds a SAS/C 6.x global symbol table to speed up compilation.
# -----------------------------------------------------------------------

plplot.gst:	plplotP.h plplot.h plamiga.h
	gst unload plplot.gst
	$(CC) makegst plplot.gst $(CC_FLAGS) pla_gstskel.c

